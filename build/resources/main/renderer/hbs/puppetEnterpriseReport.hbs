<script nonce="{{webnonce}}" type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script nonce="{{webnonce}}" type="text/javascript">

  // Load the Visualization API and the corechart package.
  google.charts.load('current', {'packages':['corechart']});

  // Set a callback to run when the Google Visualization API is loaded.
  google.charts.setOnLoadCallback(drawChart);

  // Callback that creates and populates a data table,
  // instantiates the pie chart, passes in the data and
  // draws it.
  function drawChart() {
    // Create the data table.
    var data = new google.visualization.DataTable();
    data.addColumn('string', 'Status');
    data.addColumn('number', 'Count');
    data.addRows([
      ['Changed', {{ reportdata.header.0.dataMap.changed }}],
      ['Unchanged', {{ reportdata.header.0.dataMap.unchanged }}]
    ]);

    // Set chart options
    var options = {
          'width':500,
          'height':400
      };

    // Instantiate and draw our chart, passing in some options.
    var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
</script>
<script nonce="{{webnonce}}" type="text/javascript">

  // Load the Visualization API and the corechart package.
  google.charts.load('current', {'packages':['corechart']});

  // Set a callback to run when the Google Visualization API is loaded.
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    // Create the data table.
    var data = google.visualization.arrayToDataTable([
      ["Element", "Nodes", { role: "style" } ],
      ["> 30s", {{reportdata.header.0.dataMap.above30s}}, "blue"],
      ["> 5m", {{reportdata.header.0.dataMap.above5m}}, "orange"],
      ["> 10m", 0, "green"],
      ["> 30m", 0, "red"]
    ]);

    var options = {
      width:  500,
      height: 400,
      hAxis: {
        title: 'Run Duration',
        gridlines: {
          count: 0
        },
        minorGridlines: {
          count: 0
        },
      },
      vAxis: {
        title: 'Nodes',
        minorGridlines: {
          count: 0
        }
      }
    };

    var chart = new google.visualization.ColumnChart(
    document.getElementById('runtime_chart_div'));
    chart.draw(data, options);
  }
</script>
<div>
	<h2>Integration: <b>{{integration}}</b>    Node Groups: <b>{{nodeGroups}}</b></h2>
  <row>
    <div class="col-sm-6">
      <h3 class="center">Puppet Run Status</h3>
      <div id="chart_div"></div>
    </div>
    <div class="col-sm-6">
      <h3 class="center">Puppet Run Times</h3>
      <div id="runtime_chart_div"></div>
    </div>
  </row>
  <table>
    <thead>
    <th>Report Time</th>
    <th>Name</th>
    <th>Status</th>
    <th>Version</th>
    <th>Environment</th>
    <th>Run Time (Seconds)</th>

    </thead>
    <tbody>
      {{#each reportdata.main}}
        <tr>
          <td>{{dataMap.reporttime}}</td>
          <td>{{dataMap.name}}</td>
          <td>{{dataMap.status}}</td>
          <td>{{dataMap.version}}</td>
          <td>{{dataMap.environment}}</td>
          <td>{{dataMap.runtime}}</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</div>